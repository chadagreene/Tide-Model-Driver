
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>tmd_data</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-06-13"><meta name="DC.source" content="tmd_data_documentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1><tt>tmd_data</tt></h1><!--introduction--><p><tt>tmd_data</tt> loads tide model data into the Matlab workspace.</p><p><a href="TMD_Contents.html">Back to Tide Model Driver Contents</a>.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example: Exploring tide model data</a></li><li><a href="#5">Example: Water column thickness</a></li><li><a href="#6">Example: Geographic coordinates from a regional model</a></li><li><a href="#7">Example: Constituent amplitude and phase</a></li><li><a href="#8">Example: A global model</a></li><li><a href="#9">Example: Load a small area of data</a></li><li><a href="#10">Author Info</a></li></ul></div><h2 id="1">Syntax</h2><pre>[Z,x,y] = tmd_data(filename,variable)
[...] = tmd_data(...,'constituents',conList)
[...] = tmd_data(...,'bounds',[xi yi])
[Z,lon,lat] = tmd_data(...,'geo')
[...,cons] = tmd_data(...)</pre><h2 id="2">Description</h2><p><tt>[Z,x,y] = tmd_data(filename,variable)</tt> loads any of the following variables from a given tide model file:</p><div><ul><li><tt>'h'</tt>   complex tidal height (m)</li><li><tt>'hRe'</tt> real part of tidal height</li><li><tt>'hIm'</tt> imaginary part of tidal height</li><li><tt>'hAm'</tt> amplitude of tidal height</li><li><tt>'hPh'</tt> phase of tidal height</li><li><tt>'u'</tt>   complex zonal velocity (m/s)</li><li><tt>'uRe'</tt> real part of zonal velocity</li><li><tt>'uIm'</tt> imaginary part of zonal velocity</li><li><tt>'uAm'</tt> amplitude of zonal velocity</li><li><tt>'uPh'</tt> phase of zonal velocity</li><li><tt>'U'</tt>   complex zonal transport (m^2/s)</li><li><tt>'URe'</tt>  real part of zonal transport</li><li><tt>'UIm'</tt> imaginary part of zonal transport</li><li><tt>'UAm'</tt> amplitude of zonal transport</li><li><tt>'UPh'</tt> phase of zonal transport</li><li><tt>'v'</tt>   complex meridional velocity (m/s)</li><li><tt>'vRe'</tt> real part of meridional velocity</li><li><tt>'vIm'</tt> imaginary part of meridional velocity</li><li><tt>'vAm'</tt> amplitude of meridional velocity</li><li><tt>'vPh'</tt> phase of meridional velocity</li><li><tt>'V'</tt>   complex meridional transport (m^2/s)</li><li><tt>'VRe'</tt> real part of meridional transport</li><li><tt>'VIm'</tt> imaginary part of meridional transport</li><li><tt>'VAm'</tt> amplitude of meridional transport</li><li><tt>'VPh'</tt> phase of meridional transport</li><li><tt>'wct'</tt> water column thickness (m)</li><li><tt>'mask'</tt> binary land/ocean mask</li><li><tt>'flexure'</tt> ice shelf flexure coefficient from a linear elastic model applied to BedMachine ice thickness (can slightly exceed 1). Only for CATS model.</li></ul></div><p><tt>[...] = tmd_data(...,'constituents',conList)</tt> specifies tidal constituents as a cell array (e.g, <tt>{'m2','s2'}</tt>). If constituents are not specified, all model constituents are returned.</p><p><tt>[...] = tmd_data(...,'bounds',[xi yi])</tt> enter an Mx2 matrix of coordinates to only load data in a rectangle around the specified <tt>[xi(:) yi(:)]</tt> where <tt>xi</tt> and <tt>yi</tt> are projected coordinates for tide models that are in projected coordinates. For tide models in geo coordinates (global tide models, generally), <tt>xi</tt> refers to longitudes of interest and <tt>yi</tt> is latitudes of interest. The advantage of specifying bounds is to minimize the amount of data that are loaded, when only a small area within a larger tide model is of interest.</p><p><tt>[Z,lon,lat] = tmd_data(...,'geo')</tt> returns grid coordinates as geographic coordinates. This is the default behavior for global models, whereas regional models return projected coordinates by default.</p><p><tt>[...,cons] = tmd_data(...)</tt> returns a list of constituents in the model.</p><h2 id="3">Example: Exploring tide model data</h2><p>Explore the model data for the height variable <tt>h</tt> in the CATS model. (Here I'm defining <tt>fn</tt> as the filename of the version of CATS I'm working on at the moment, but you may have a different model filename.)</p><pre class="codeinput"><span class="comment">% Filename:</span>
fn = <span class="string">'CATS2008_update_2022-06-11.nc'</span>;

<span class="comment">% Load complex height coefficients:</span>
[h,x,y,cons] = tmd_data(fn,<span class="string">'h'</span>);

<span class="comment">% Examine outputs:</span>
whos <span class="string">h</span> <span class="string">x</span> <span class="string">y</span> <span class="string">cons</span>
</pre><pre class="codeoutput">  Name         Size                      Bytes  Class     Attributes

  cons         1x10                       1080  cell                
  h         4051x3325x10            2155132000  double    complex   
  x         3325x1                       26600  double              
  y         4051x1                       32408  double              

</pre><p>Above, we see that <tt>h</tt> is a complex variable whose dimensions correspond to <tt>y</tt>, <tt>x</tt>, and the constituents in the model.</p><h2 id="5">Example: Water column thickness</h2><p>Using the same CATS filename <tt>fn</tt> we defined above, load and plot the water column thickness:</p><pre class="codeinput"><span class="comment">% Load water column thickness:</span>
[wct,x,y] = tmd_data(fn,<span class="string">'wct'</span>);

figure
imagesc(x,y,wct)
axis <span class="string">xy</span> <span class="string">image</span>
xlabel <span class="string">'x (kilometers')</span>
ylabel <span class="string">'y (kilometers')</span>
cb = colorbar;
ylabel(cb,<span class="string">'water column thickness (m)'</span>)
cmocean <span class="string">deep</span> <span class="comment">% optional colormap</span>
</pre><img vspace="5" hspace="5" src="tmd_data_documentation_01.png" alt=""> <h2 id="6">Example: Geographic coordinates from a regional model</h2><p>You see above that the regional CATS model was generated in a nonstandard projection. If you don't want to work in the CATS model coordinates, you can unproject them yourself with <tt>tmd_ps2ll</tt> or you can include the <tt>'geo'</tt> flag to get the geographic coordinates when you call <tt>tmd_data</tt>.</p><p>Below, I'm plotting with <a href="https://github.com/chadagreene/Antarctic-Mapping-Tools">Antarctic Mapping Tools'</a> <tt>pcolorps</tt> function, but you can use <tt>lat</tt> and <tt>lon</tt> with any geographic plotting functions like MATLAB's <tt>pcolorm</tt> or M_Map's <tt>m_pcolor</tt>:</p><pre class="codeinput">[wct,lon,lat] = tmd_data(fn,<span class="string">'wct'</span>,<span class="string">'geo'</span>);

figure
pcolorps(lat,lon,wct) <span class="comment">% requires AMT</span>
bedmachine <span class="comment">% plots Antarctic coastline, if you have the bedmachine toolbox</span>
cb = colorbar;
ylabel(cb,<span class="string">'water column thickness (m)'</span>)
cmocean <span class="string">deep</span> <span class="comment">% optional colormap</span>
axis <span class="string">tight</span> <span class="string">off</span>
graticuleps <span class="comment">% geographic grid lines</span>
</pre><img vspace="5" hspace="5" src="tmd_data_documentation_02.png" alt=""> <h2 id="7">Example: Constituent amplitude and phase</h2><p>Here's how you may load and plot the amplitude and phase of the s2 constituent from a model file:</p><pre class="codeinput">[hAm,x,y] = tmd_data(fn,<span class="string">'hAm'</span>,<span class="string">'constituents'</span>,<span class="string">'s2'</span>);
hPh = tmd_data(fn,<span class="string">'hPh'</span>,<span class="string">'constituents'</span>,<span class="string">'s2'</span>);
ocean = tmd_data(fn,<span class="string">'mask'</span>);

<span class="comment">% Mask out land areas:</span>
hAm(~ocean) = NaN;
hPh(~ocean) = NaN;

figure
h=imagesc(x,y,hAm);
h.AlphaData = ocean; <span class="comment">% makes land transparent</span>
axis <span class="string">xy</span> <span class="string">image</span>
hold <span class="string">on</span>
contour(x,y,rad2deg(hPh),-180:30:180,<span class="string">'k'</span>)
xlabel <span class="string">'easting (km)'</span>
ylabel <span class="string">'northing (km)'</span>
caxis([0 1.2])
</pre><img vspace="5" hspace="5" src="tmd_data_documentation_03.png" alt=""> <h2 id="8">Example: A global model</h2><p>Working with global models is very similar to working with regional models. The only real difference is we let lon=x and lat=y. Here's an example:</p><pre class="codeinput"><span class="comment">% Load the M2 global tidal height amplitude:</span>
[M2,lon,lat] = tmd_data(<span class="string">'TPXO9_atlas_v5.nc'</span>,<span class="string">'hAm'</span>,<span class="string">'constituents'</span>,<span class="string">'m2'</span>);

<span class="comment">% Load the global ocean mask:</span>
ocean = tmd_data(<span class="string">'TPXO9_atlas_v5.nc'</span>,<span class="string">'mask'</span>);

figure
h=imagesc(lon,lat,M2);
h.AlphaData = ocean; <span class="comment">% makes land transparent</span>
axis <span class="string">xy</span> <span class="string">image</span>
cb = colorbar;
ylabel(cb,<span class="string">'M2 height amplitude (m)'</span>)
xlabel(<span class="string">'longitude'</span>)
ylabel(<span class="string">'latitude'</span>)
caxis([0 2])
cmocean <span class="string">amp</span> <span class="comment">% optional colormap</span>
</pre><img vspace="5" hspace="5" src="tmd_data_documentation_04.png" alt=""> <h2 id="9">Example: Load a small area of data</h2><p>Let's say you want to use a global tide model, but you're only interested in the ocean around India. In such cases, you may not want to load the entire global dataset, so load the data surrounding your region of interest by specifiying the bounds as an Nx2 array, defining any number N data points whose x (or longitude for a global model) values are the first column, and y values (or latitude for a global model) are the second column.</p><p>Below, I'm setting the colormap with the <tt>cmocean</tt> function, and adding hillshade with <tt>shadem</tt>, both of which are in the <a href="https://github.com/chadagreene/CDT">Climate Data Toolbox for Matlab</a> (Greene et al., 2019).</p><pre class="codeinput"><span class="comment">% Some points defining your region of interest:</span>
loni = [63.57 56.40 56.77 57.88 76.30 85.81 98.67 98.29 82.47];
lati = [26.36 23.77 10.30  1.03  1.15  2.26  6.84 23.89 26.61];

<span class="comment">% Load model data around the points of interest:</span>
[wct,lon,lat] = tmd_data(<span class="string">'TPXO9_atlas_v5.nc'</span>,<span class="string">'wct'</span>,<span class="string">'bounds'</span>,[loni(:) lati(:)]);
ocean = tmd_data(<span class="string">'TPXO9_atlas_v5.nc'</span>,<span class="string">'mask'</span>,<span class="string">'bounds'</span>,[loni(:) lati(:)]);

<span class="comment">% Set land areas to NaN:</span>
wct(~ocean) = nan;

figure
pcolor(lon,lat,wct)
shading <span class="string">interp</span>
set(gca,<span class="string">'color'</span>,.5*[1 1 1]) <span class="comment">% sets background (land) to gray</span>
axis <span class="string">xy</span> <span class="string">image</span>
cb = colorbar;
ylabel(cb,<span class="string">'water column thickness (m)'</span>)
hold <span class="string">on</span>
plot(loni,lati,<span class="string">'ro-'</span>,<span class="string">'linewidth'</span>,2)
xlabel <span class="string">'longitude'</span>
ylabel <span class="string">'latitude'</span>
cmocean <span class="string">deep</span> <span class="comment">% optional colormap</span>
shadem(-13) <span class="comment">% a tiny bit of hillshade</span>
</pre><img vspace="5" hspace="5" src="tmd_data_documentation_05.png" alt=""> <h2 id="10">Author Info</h2><p>The <tt>tmd_data</tt> function and its documentation were written by Chad A. Greene, June 2022.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% |tmd_data|
% |tmd_data| loads tide model data into the Matlab workspace. 
% 
% <TMD_Contents.html Back to Tide Model Driver Contents>.
%% Syntax 
% 
%  [Z,x,y] = tmd_data(filename,variable)
%  [...] = tmd_data(...,'constituents',conList)
%  [...] = tmd_data(...,'bounds',[xi yi])
%  [Z,lon,lat] = tmd_data(...,'geo')
%  [...,cons] = tmd_data(...)
%
%% Description 
% 
% |[Z,x,y] = tmd_data(filename,variable)| loads any of the following
% variables from a given tide model file: 
% 
% * |'h'|   complex tidal height (m)  
% * |'hRe'| real part of tidal height
% * |'hIm'| imaginary part of tidal height 
% * |'hAm'| amplitude of tidal height
% * |'hPh'| phase of tidal height
% * |'u'|   complex zonal velocity (m/s) 
% * |'uRe'| real part of zonal velocity 
% * |'uIm'| imaginary part of zonal velocity 
% * |'uAm'| amplitude of zonal velocity
% * |'uPh'| phase of zonal velocity
% * |'U'|   complex zonal transport (m^2/s) 
% * |'URe'|  real part of zonal transport
% * |'UIm'| imaginary part of zonal transport
% * |'UAm'| amplitude of zonal transport
% * |'UPh'| phase of zonal transport 
% * |'v'|   complex meridional velocity (m/s) 
% * |'vRe'| real part of meridional velocity 
% * |'vIm'| imaginary part of meridional velocity
% * |'vAm'| amplitude of meridional velocity
% * |'vPh'| phase of meridional velocity 
% * |'V'|   complex meridional transport (m^2/s)
% * |'VRe'| real part of meridional transport 
% * |'VIm'| imaginary part of meridional transport
% * |'VAm'| amplitude of meridional transport
% * |'VPh'| phase of meridional transport
% * |'wct'| water column thickness (m) 
% * |'mask'| binary land/ocean mask
% * |'flexure'| ice shelf flexure coefficient from a linear elastic model applied to BedMachine ice thickness (can slightly exceed 1). Only for CATS model. 
%
% |[...] = tmd_data(...,'constituents',conList)| specifies tidal constituents as a 
% cell array (e.g, |{'m2','s2'}|). If constituents are not specified, all model
% constituents are returned. 
%
% |[...] = tmd_data(...,'bounds',[xi yi])| enter an Mx2 matrix of coordinates 
% to only load data in a rectangle around the specified |[xi(:) yi(:)]| where
% |xi| and |yi| are projected coordinates for tide models that are in projected
% coordinates. For tide models in geo coordinates (global tide models,
% generally), |xi| refers to longitudes of interest and |yi| is latitudes of interest. 
% The advantage of specifying bounds is to minimize the amount of data that
% are loaded, when only a small area within a larger tide model is of
% interest. 
% 
% |[Z,lon,lat] = tmd_data(...,'geo')| returns grid coordinates as
% geographic coordinates. This is the default behavior for global models,
% whereas regional models return projected coordinates by default. 
%
% |[...,cons] = tmd_data(...)| returns a list of constituents in the model.  
% 
%% Example: Exploring tide model data
% Explore the model data for the height variable |h| in the CATS model.
% (Here I'm defining |fn| as the filename of the version of CATS I'm
% working on at the moment, but you may have a different model filename.)

% Filename: 
fn = 'CATS2008_update_2022-06-11.nc';

% Load complex height coefficients:
[h,x,y,cons] = tmd_data(fn,'h'); 

% Examine outputs: 
whos h x y cons

%% 
% Above, we see that |h| is a complex variable whose dimensions correspond
% to |y|, |x|, and the constituents in the model. 

%% Example: Water column thickness
% Using the same CATS filename |fn| we defined above, load and plot the water column
% thickness:

% Load water column thickness:
[wct,x,y] = tmd_data(fn,'wct'); 

figure
imagesc(x,y,wct)
axis xy image 
xlabel 'x (kilometers') 
ylabel 'y (kilometers')
cb = colorbar; 
ylabel(cb,'water column thickness (m)') 
cmocean deep % optional colormap 

%% Example: Geographic coordinates from a regional model
% You see above that the regional CATS model was generated in a nonstandard
% projection. If you don't want to work in the CATS model coordinates, you 
% can unproject them yourself with |tmd_ps2ll| or you can include the |'geo'| 
% flag to get the geographic coordinates when you call |tmd_data|.
% 
% Below, I'm plotting with <https://github.com/chadagreene/Antarctic-Mapping-Tools Antarctic Mapping Tools'>
% |pcolorps| function, but you can use |lat| and |lon| with any geographic 
% plotting functions like MATLAB's |pcolorm| or M_Map's |m_pcolor|: 

[wct,lon,lat] = tmd_data(fn,'wct','geo'); 

figure
pcolorps(lat,lon,wct) % requires AMT
bedmachine % plots Antarctic coastline, if you have the bedmachine toolbox
cb = colorbar; 
ylabel(cb,'water column thickness (m)') 
cmocean deep % optional colormap 
axis tight off
graticuleps % geographic grid lines 

%% Example: Constituent amplitude and phase
% Here's how you may load and plot the amplitude and phase of the s2 constituent
% from a model file: 

[hAm,x,y] = tmd_data(fn,'hAm','constituents','s2');  
hPh = tmd_data(fn,'hPh','constituents','s2'); 
ocean = tmd_data(fn,'mask'); 

% Mask out land areas: 
hAm(~ocean) = NaN; 
hPh(~ocean) = NaN; 

figure
h=imagesc(x,y,hAm);
h.AlphaData = ocean; % makes land transparent
axis xy image
hold on
contour(x,y,rad2deg(hPh),-180:30:180,'k')
xlabel 'easting (km)' 
ylabel 'northing (km)' 
caxis([0 1.2])

%% Example: A global model
% Working with global models is very similar to working with regional
% models. The only real difference is we let lon=x and lat=y. Here's an
% example: 

% Load the M2 global tidal height amplitude: 
[M2,lon,lat] = tmd_data('TPXO9_atlas_v5.nc','hAm','constituents','m2'); 

% Load the global ocean mask: 
ocean = tmd_data('TPXO9_atlas_v5.nc','mask'); 

figure
h=imagesc(lon,lat,M2);
h.AlphaData = ocean; % makes land transparent
axis xy image
cb = colorbar; 
ylabel(cb,'M2 height amplitude (m)') 
xlabel('longitude')
ylabel('latitude') 
caxis([0 2])
cmocean amp % optional colormap

%% Example: Load a small area of data 
% Let's say you want to use a global tide model, but you're only interested
% in the ocean around India. In such cases, you may not want to load the
% entire global dataset, so load the data surrounding your region of
% interest by specifiying the bounds as an Nx2 array, defining any number N
% data points whose x (or longitude for a global model) values are the
% first column, and y values (or latitude for a global model) are the
% second column. 
%
% Below, I'm setting the colormap with the |cmocean| function, and adding
% hillshade with |shadem|, both of which are in the <https://github.com/chadagreene/CDT Climate Data Toolbox for Matlab>
% (Greene et al., 2019). 

% Some points defining your region of interest: 
loni = [63.57 56.40 56.77 57.88 76.30 85.81 98.67 98.29 82.47];
lati = [26.36 23.77 10.30  1.03  1.15  2.26  6.84 23.89 26.61];    

% Load model data around the points of interest: 
[wct,lon,lat] = tmd_data('TPXO9_atlas_v5.nc','wct','bounds',[loni(:) lati(:)]); 
ocean = tmd_data('TPXO9_atlas_v5.nc','mask','bounds',[loni(:) lati(:)]); 

% Set land areas to NaN:
wct(~ocean) = nan;

figure
pcolor(lon,lat,wct)
shading interp
set(gca,'color',.5*[1 1 1]) % sets background (land) to gray
axis xy image
cb = colorbar; 
ylabel(cb,'water column thickness (m)') 
hold on
plot(loni,lati,'ro-','linewidth',2)
xlabel 'longitude'
ylabel 'latitude'
cmocean deep % optional colormap
shadem(-13) % a tiny bit of hillshade

%% Author Info 
% The |tmd_data| function and its documentation were written by Chad A.
% Greene, June 2022. 
##### SOURCE END #####
--></body></html>