
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Getting Started with TMD</title><meta name="generator" content="MATLAB 9.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-08-04"><meta name="DC.source" content="tmd_getting_started.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Getting Started with TMD</h1><!--introduction--><p><a href="TMD_Contents.html">Back to Tide Model Driver Contents</a>.</p><p>This page contains the code from the introductory video tutorial found on youtube.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">1. Installing TMD</a></li><li><a href="#2">2. Getting tide model data</a></li><li><a href="#3">3. Getting help</a></li><li><a href="#4">4. Predicting tides</a></li><li><a href="#5">Single-location time series</a></li><li><a href="#6">Drift-track time series</a></li><li><a href="#7">Map-view snapshot</a></li><li><a href="#9">5. Accessing tide model data</a></li><li><a href="#15">Author Info</a></li></ul></div><h2 id="1">1. Installing TMD</h2><p>The first step toward getting started with TMD is to install the software on your computer. If you're reading this in the MATLAB documentation browser, I'll assume you've already done gotten TMD installed.</p><h2 id="2">2. Getting tide model data</h2><p>After you've installed the TMD functions, you'll need some tide model data. Go to the <a href="https://github.com/chadagreene/Tide-Model-Driver">TMD GitHub repo</a> for an up-to-date list of available tide models.</p><h2 id="3">3. Getting help</h2><div><ul><li><b>Online:</b> The most up-to-date documentation can always be found on the <a href="https://github.com/chadagreene/Tide-Model-Driver">TMD Github Repo</a>. There you can also post issues if you find any bugs in the code.</li><li><b>In MATLAB:</b> If you're in MATLAB and you want help with a specific function, you can get plain-text help in the Command Window by typing <tt>help</tt> followed by the name of the function. For example:</li></ul></div><pre>help tmd_predict</pre><p>To access formatted documentation with lots of examples for any of the primary TMD functions, type <tt>tmd</tt> followed by the function name. For example:</p><pre>tmd tmd_predict</pre><p>If you're not sure what function name you're looking for, just type <tt>tmd</tt> into the Command Window, and it will bring up a complete function list:</p><pre>tmd</pre><h2 id="4">4. Predicting tides</h2><p>The procedure for predicting tides is described in detail in the documentation for the <a href="tmd_predict_documentation.html"><tt>tmd_predict</tt></a>  function, but we'll cover a few quick examples here. After downloading your favorite tide model data file, unzip it, <a href="https://www.mathworks.com/help/matlab/ref/addpath.html">make sure MATLAB can find it</a>, and then enter the location and times that you want to predict tides.</p><h2 id="5">Single-location time series</h2><p>Use the Gr1kmTM_v1 tide model to predict tides in Baffin Bay (74.6&deg;N,68.2&deg;W) for the month of January, 2020, at hourly resolution:</p><pre class="codeinput"><span class="comment">% Define a time array:</span>
t = datetime(<span class="string">'jan 1, 2020'</span>):hours(1):datetime(<span class="string">'jan 31, 2020'</span>);

<span class="comment">% Predict the tide time series:</span>
z = tmd_predict(<span class="string">'Gr1kmTM_v1.nc'</span>,74.6,-68.2,t);

figure
plot(t,z)
box <span class="string">off</span>
ylabel(<span class="string">'tide height (m)'</span>)
</pre><img vspace="5" hspace="5" src="tmd_getting_started_01.png" alt=""> <h2 id="6">Drift-track time series</h2><p>Predicting a drift track is very similar to predicting a single-location time series, except you'll enter lat,lon arrays that are the same size as the time array.</p><p>Let's say you take a boat across Baffin Bay for two days in January 2020 and you want to predict tides along the path. The red in the scatterplot below corresponds to high tides you'll encounter along your journey.</p><pre class="codeinput"><span class="comment">% Two day time series:</span>
t = datetime(<span class="string">'jan 10, 2020'</span>):minutes(1):datetime(<span class="string">'jan 12, 2020'</span>);

<span class="comment">%  Corresponding locations:</span>
lat = linspace(75.6,71.9,length(t));
lon = linspace(-74.8,-57.4,length(t));

z = tmd_predict(<span class="string">'Gr1kmTM_v1.nc'</span>,lat,lon,t);

figure
geoscatter(lat,lon,20,z,<span class="string">'filled'</span>)
geolimits([68 78],[-85 -45])
geobasemap <span class="string">colorterrain</span>
caxis([-1 1]*1.1)
cb = colorbar;
ylabel(cb,<span class="string">'tide height (m)'</span>)
cmocean <span class="string">balance</span> <span class="comment">% optional colormap</span>
</pre><img vspace="5" hspace="5" src="tmd_getting_started_02.png" alt=""> <h2 id="7">Map-view snapshot</h2><p>Suppose you just want a snapshot of the geographic distribution of tide heights across a wide area at a single instant. Let's pick 4:15 pm on January 12, 2020, and we'll choose an area around Baffin Bay.</p><pre class="codeinput"><span class="comment">% Define arrays of equally spaced lat,lon locations:</span>
lat = 60:0.05:90;
lon = -100:0.1:-20;

<span class="comment">% Turn the arrays into grids:</span>
[Lon,Lat] = meshgrid(lon,lat);

<span class="comment">% Predict tides at 4:15 pm (UTC) on January 12, 2020:</span>
t = datenum(<span class="string">'jan 12, 2020, 16:15'</span>);
Z = tmd_predict(<span class="string">'Gr1kmTM_v1.nc'</span>,Lat,Lon,t);

figure
pcolor(lon,lat,Z)
shading <span class="string">interp</span>
cb = colorbar;
ylabel(cb,<span class="string">'tide height (m)'</span>)
caxis([-1 1]*2.8)
xlabel <span class="string">'longitude'</span>
ylabel <span class="string">'latitude'</span>
cmocean <span class="string">bal</span> <span class="comment">% optional colormap from Climate Data Toolox</span>
</pre><img vspace="5" hspace="5" src="tmd_getting_started_03.png" alt=""> <p>You may also add column-averaged water velocity vectors like this:</p><pre class="codeinput">u = tmd_predict(<span class="string">'Gr1kmTM_v1.nc'</span>,Lat,Lon,t,<span class="string">'u'</span>);
v = tmd_predict(<span class="string">'Gr1kmTM_v1.nc'</span>,Lat,Lon,t,<span class="string">'v'</span>);

hold <span class="string">on</span>
q = quiversc(lon,lat,u,v,<span class="string">'k'</span>); <span class="comment">% quiversc is in Climate Data Toolbox</span>
q.AutoScaleFactor = 1.5; <span class="comment">% lengthens the arrows</span>
</pre><img vspace="5" hspace="5" src="tmd_getting_started_04.png" alt=""> <h2 id="9">5. Accessing tide model data</h2><p>You can use <tt>tmd_interp</tt> to interpolate quantities from the model data file, like ocean masks or constituent coefficients. Here we get the water column thickness (essentially the ocean depth) at every grid point we defined above:</p><pre class="codeinput">wct = tmd_interp(<span class="string">'Gr1kmTM_v1.nc'</span>,<span class="string">'wct'</span>,Lat,Lon);

figure
pcolor(lon,lat,wct)
shading <span class="string">interp</span>
cb = colorbar;
ylabel(cb,<span class="string">'water column thickness (m)'</span>)
cmocean <span class="string">deep</span> <span class="comment">% optional colormap</span>
</pre><img vspace="5" hspace="5" src="tmd_getting_started_05.png" alt=""> <p>Above, the water column thickness is zero wherever there's land. Perhaps you'd prefer to set the land grid cells to NaN rather than zero. Here's how: Just interpolate the ocean mask, set the non-ocean pixels to NaN, and plot again:</p><pre class="codeinput">ocean = tmd_interp(<span class="string">'Gr1kmTM_v1.nc'</span>,<span class="string">'mask'</span>,Lat,Lon);

wct(~ocean) = NaN;

figure
pcolor(lon,lat,wct)
shading <span class="string">interp</span>
cb = colorbar;
ylabel(cb,<span class="string">'water column thickness (m)'</span>)
cmocean <span class="string">deep</span> <span class="comment">% optional colormap</span>
</pre><img vspace="5" hspace="5" src="tmd_getting_started_06.png" alt=""> <p>Sometimes you don't want to interpolate, and you just want the raw data. Use <a href="tmd_data_documentation.html"><tt>tmd_data</tt></a> to get things like height coefficients:</p><pre class="codeinput"><span class="comment">% Load complex height coefficients:</span>
[h,x,y,cons] = tmd_data(<span class="string">'Gr1kmTM_v1.nc'</span>,<span class="string">'h'</span>);

<span class="comment">% Examine outputs:</span>
whos <span class="string">h</span> <span class="string">x</span> <span class="string">y</span> <span class="string">cons</span>
</pre><pre class="codeoutput">  Name         Size                    Bytes  Class     Attributes

  cons         1x8                       864  cell                
  h         3530x2190x8            989529600  double    complex   
  x         2190x1                     17520  double              
  y         3530x1                     28240  double              

</pre><p>Above, we see the the Gr1kmTM_v1.nc file conntains eight tidal constituents. Here's what they are:</p><pre class="codeinput">cons
</pre><pre class="codeoutput">cons =
  1&times;8 cell array
  Columns 1 through 7
    {'m2'}    {'s2'}    {'k1'}    {'o1'}    {'n2'}    {'p1'}    {'k2'}
  Column 8
    {'q1'}
</pre><p>You can alternatively access constituents using the <a href="tmd_conlist_documentation.html"><tt>tmd_conlist</tt></a> function:</p><pre class="codeinput">tmd_conlist(<span class="string">'Gr1kmTM_v1.nc'</span>)
</pre><pre class="codeoutput">ans =
  1&times;8 cell array
  Columns 1 through 7
    {'m2'}    {'s2'}    {'k1'}    {'o1'}    {'n2'}    {'p1'}    {'k2'}
  Column 8
    {'q1'}
</pre><p>The variable <tt>h</tt> is a complex data cube with dimensions 3530x2190x8, which correspond to the <i>y</i> and <i>x</i> dimensions and the eight constituents. If you'd just like the <i>amplitude</i> (not complex) of the m2 coefficient, enter <tt>'hAm'</tt> and the constituent you desire, like this:</p><pre class="codeinput"><span class="comment">% Load the M2 global tidal height amplitude:</span>
[M2,x,y] = tmd_data(<span class="string">'Gr1kmTM_v1.nc'</span>,<span class="string">'hAm'</span>,<span class="string">'constituents'</span>,<span class="string">'m2'</span>);

<span class="comment">% Load the global ocean mask:</span>
ocean = tmd_data(<span class="string">'Gr1kmTM_v1.nc'</span>,<span class="string">'mask'</span>);

figure
h=imagesc(x,y,M2);
h.AlphaData = ocean; <span class="comment">% makes land transparent</span>
axis <span class="string">xy</span> <span class="string">image</span> <span class="comment">% sets axes equal and normal cartesian coordinates</span>
cb = colorbar;
ylabel(cb,<span class="string">'M2 height amplitude (m)'</span>)
xlabel(<span class="string">'x coordinate (km)'</span>)
ylabel(<span class="string">'y coordinate (km)'</span>)
cmocean <span class="string">amp</span> <span class="comment">% optional colormap from Climate Data Toolbox</span>
</pre><img vspace="5" hspace="5" src="tmd_getting_started_07.png" alt=""> <h2 id="15">Author Info</h2><p>This page was written by Chad A. Greene, June 2022, updated August 2023.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Getting Started with TMD
% <TMD_Contents.html Back to Tide Model Driver Contents>.
% 
% This page contains the code from the introductory video tutorial found 
% on youtube. 
%
%% 1. Installing TMD 
% The first step toward getting started with TMD is to install the software
% on your computer. If you're reading this in the MATLAB documentation
% browser, I'll assume you've already done gotten TMD installed.

%% 2. Getting tide model data 
% After you've installed the TMD functions, you'll need some tide model data.
% Go to the <https://github.com/chadagreene/Tide-Model-Driver TMD GitHub repo>  
% for an up-to-date list of available tide models. 

%% 3. Getting help 
% * *Online:* The most up-to-date documentation can always be found on the 
% <https://github.com/chadagreene/Tide-Model-Driver TMD Github Repo>. There you can also post issues if you find any bugs in the code.  
% * *In MATLAB:* If you're in MATLAB and you want help with a specific function, you can get plain-text help in the 
% Command Window by typing |help| followed by the name of the function. For example: 
% 
%  help tmd_predict
% 
% To access formatted documentation with lots of examples for any of the primary 
% TMD functions, type |tmd| followed by the function name. For example:
% 
%  tmd tmd_predict
% 
% If you're not sure what function name you're looking for, just type |tmd| into the Command Window, 
% and it will bring up a complete function list:
% 
%  tmd 
% 
%% 4. Predicting tides 
% The procedure for predicting tides is described in detail in the documentation for the 
% <tmd_predict_documentation.html |tmd_predict|>  function, but we'll cover a few quick 
% examples here. After downloading your favorite tide model data file, unzip it, 
% <https://www.mathworks.com/help/matlab/ref/addpath.html make sure MATLAB can find it>, and 
% then enter the location and times that you want to predict tides. 
% 
%% Single-location time series
% Use the Gr1kmTM_v1 tide model to predict tides in Baffin Bay (74.6°N,68.2°W) for the month of January,
% 2020, at hourly resolution: 

% Define a time array: 
t = datetime('jan 1, 2020'):hours(1):datetime('jan 31, 2020'); 

% Predict the tide time series:
z = tmd_predict('Gr1kmTM_v1.nc',74.6,-68.2,t); 

figure
plot(t,z) 
box off
ylabel('tide height (m)') 

%% Drift-track time series
% Predicting a drift track is very similar to predicting a single-location
% time series, except you'll enter lat,lon arrays that are the same size as
% the time array. 
% 
% Let's say you take a boat across Baffin Bay for two days in January
% 2020 and you want to predict tides along the path. The red in the 
% scatterplot below corresponds to high tides you'll encounter along your
% journey. 

% Two day time series: 
t = datetime('jan 10, 2020'):minutes(1):datetime('jan 12, 2020'); 

%  Corresponding locations: 
lat = linspace(75.6,71.9,length(t));
lon = linspace(-74.8,-57.4,length(t));

z = tmd_predict('Gr1kmTM_v1.nc',lat,lon,t); 

figure
geoscatter(lat,lon,20,z,'filled')
geolimits([68 78],[-85 -45])
geobasemap colorterrain
caxis([-1 1]*1.1)
cb = colorbar; 
ylabel(cb,'tide height (m)')
cmocean balance % optional colormap 

%% Map-view snapshot
% Suppose you just want a snapshot of the geographic distribution of 
% tide heights across a wide area at a single instant. Let's pick 4:15 pm
% on January 12, 2020, and we'll choose an area around Baffin Bay. 

% Define arrays of equally spaced lat,lon locations: 
lat = 60:0.05:90; 
lon = -100:0.1:-20; 

% Turn the arrays into grids: 
[Lon,Lat] = meshgrid(lon,lat); 

% Predict tides at 4:15 pm (UTC) on January 12, 2020: 
t = datenum('jan 12, 2020, 16:15');
Z = tmd_predict('Gr1kmTM_v1.nc',Lat,Lon,t); 

figure
pcolor(lon,lat,Z)
shading interp
cb = colorbar; 
ylabel(cb,'tide height (m)') 
caxis([-1 1]*2.8)
xlabel 'longitude'
ylabel 'latitude'
cmocean bal % optional colormap from Climate Data Toolox

%%
% You may also add column-averaged water velocity vectors like this:

u = tmd_predict('Gr1kmTM_v1.nc',Lat,Lon,t,'u'); 
v = tmd_predict('Gr1kmTM_v1.nc',Lat,Lon,t,'v'); 

hold on
q = quiversc(lon,lat,u,v,'k'); % quiversc is in Climate Data Toolbox 
q.AutoScaleFactor = 1.5; % lengthens the arrows 

%% 5. Accessing tide model data 
% You can use |tmd_interp| to interpolate quantities from the model 
% data file, like ocean masks or constituent coefficients. Here we 
% get the water column thickness (essentially the ocean depth) at every 
% grid point we defined above: 

wct = tmd_interp('Gr1kmTM_v1.nc','wct',Lat,Lon); 

figure
pcolor(lon,lat,wct)
shading interp 
cb = colorbar; 
ylabel(cb,'water column thickness (m)')
cmocean deep % optional colormap 

%%
% Above, the water column thickness is zero wherever there's land. Perhaps
% you'd prefer to set the land grid cells to NaN rather than zero. Here's
% how: Just interpolate the ocean mask, set the non-ocean pixels to NaN,
% and plot again: 

ocean = tmd_interp('Gr1kmTM_v1.nc','mask',Lat,Lon); 

wct(~ocean) = NaN; 

figure
pcolor(lon,lat,wct)
shading interp 
cb = colorbar; 
ylabel(cb,'water column thickness (m)')
cmocean deep % optional colormap 

%%
% Sometimes you don't want to interpolate, and you just want the raw data. 
% Use <tmd_data_documentation.html |tmd_data|> to get things like height
% coefficients: 

% Load complex height coefficients:
[h,x,y,cons] = tmd_data('Gr1kmTM_v1.nc','h'); 

% Examine outputs: 
whos h x y cons

%%  
% Above, we see the the Gr1kmTM_v1.nc file conntains eight tidal
% constituents. Here's what they are: 

cons

%% 
% You can alternatively access constituents using the
% <tmd_conlist_documentation.html |tmd_conlist|> function:

tmd_conlist('Gr1kmTM_v1.nc')

%% 
% The variable |h| is a complex data cube with dimensions 3530x2190x8, which
% correspond to the _y_ and _x_ dimensions and the eight constituents. If
% you'd just like the _amplitude_ (not complex) of the m2 coefficient,
% enter |'hAm'| and the constituent you desire, like this: 

% Load the M2 global tidal height amplitude: 
[M2,x,y] = tmd_data('Gr1kmTM_v1.nc','hAm','constituents','m2'); 

% Load the global ocean mask: 
ocean = tmd_data('Gr1kmTM_v1.nc','mask'); 

figure
h=imagesc(x,y,M2);
h.AlphaData = ocean; % makes land transparent
axis xy image % sets axes equal and normal cartesian coordinates 
cb = colorbar; 
ylabel(cb,'M2 height amplitude (m)') 
xlabel('x coordinate (km)')
ylabel('y coordinate (km)') 
cmocean amp % optional colormap from Climate Data Toolbox 

%% Author Info
% This page was written by Chad A. Greene, June 2022, updated August 2023. 
##### SOURCE END #####
--></body></html>